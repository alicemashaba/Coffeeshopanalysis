Analysis of the Coffee shop sales 
SELECT
  SUM(TRANSACTION_QTY*UNIT_PRICE) AS TOTAL_REVENUE,
  SUM(TRANSACTION_QTY)AS NUMBER_OF_UNITS_SOLD,
  COUNT(TRANSACTION_ID) AS NUMBER_OF_SALES,
  TO_CHAR(TRANSACTION_DATE,'YYYYMM') AS MONTH_ID,
  MONTHNAME(TRANSACTION_DATE) AS MONTH_NAME,
  DAYNAME(TRANSACTION_DATE) AS DAY_NAME,
  CASE
      WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'Morning'
      WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '16:59:59' THEN 'Afternoon'
      WHEN TRANSACTION_TIME BETWEEN '17:00:00' AND '19:59:59' THEN 'Evening'
      ELSE 'Night'
END AS TIME_BUCKET,
 CASE 
     WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 0 AND 20 THEN 'Low'
     WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 21 AND 40 THEN 'Med'
     WHEN SUM(TRANSACTION_QTY*UNIT_PRICE) BETWEEN 41 AND 60 THEN 'High'
  ELSE 'Very High'
  END AS spend_bands,
    PRODUCT_CATEGORY,
    PRODUCT_TYPE,
    PRODUCT_DETAIL,
    STORE_LOCATION,
FROM
  "COFFEE"."SHOP"."COFFEESHOPSALES"
GROUP BY TIME_BUCKET,
        PRODUCT_CATEGORY,
        PRODUCT_TYPE,
        PRODUCT_DETAIL,
        STORE_LOCATION,
        MONTH_ID,
        MONTH_NAME,
        DAY_NAME;
